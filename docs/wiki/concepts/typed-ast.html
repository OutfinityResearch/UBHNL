<!doctype html>
<html lang="ro">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Wiki: Typed semantic IR / AST</title>
    <link rel="stylesheet" href="../../site.css" />
  </head>
  <body>
    <header>
      <h1>Typed semantic IR / AST</h1>
      <p>Contractul stabil între front-end (CNL/DSL) și compilare/solving.</p>
    </header>
    <main>
      <div class="card">
        <div class="draft">DRAFT: pagină de Wiki.</div>

        <div class="nav">
          <a href="../index.html">Wiki</a>
          <a href="cnl.html">CNL</a>
          <a href="dsl.html">DSL</a>
          <a href="type-lowering.html">Type lowering</a>
          <a href="../../mdview.html?file=specs/DS/006-nl-pipeline.md">DS-006</a>
        </div>

        <h2>Definiție</h2>
        <p>
          <strong>Typed semantic IR</strong> este reprezentarea internă (structuri de date) care capturează sensul logic al inputului,
          cu <strong>tipuri</strong> atașate (domenii finite sau builtins), înainte de lowering către fragmente/backends.
        </p>

        <h2>De ce e necesar</h2>
        <ul>
          <li>Separă “parsing” de “solving”: solverul nu trebuie să știe despre tokeni/alias-uri.</li>
          <li>Permite <strong>fragment detection</strong> (DS-010): din IR îți dai seama dacă e UBH/SAT, SMT(BV), TS, etc.</li>
          <li>Este punctul ideal pentru normalizări (de ex. desugaring <code>if ... then ...</code>).</li>
        </ul>

        <h2>Core logic AST (minimal)</h2>
        <p>
          Pentru CNL determinist, există un subset de noduri:
        </p>
        <pre><code>ForAll(var, domain, body)
Exists(var, domain, body)
And/Or/Not/Implies
Pred(name, args[])
BoolLit(true/false)</code></pre>

        <h2>Legătura cu UBH</h2>
        <ul>
          <li>Expresiile core logic se compilează în UBH folosind baza XOR/AND/CONST (<a href="ubh.html">UBH</a>).</li>
          <li>Cuantificatorii pe domenii finite se expandă sau devin schema (CEGAR) — vezi <a href="cegar.html">CEGAR</a>.</li>
        </ul>

        <h2>Consecințe</h2>
        <ul>
          <li>Erorile sunt clasificate: Parse/Resolve/Type, cu poziții în fișier.</li>
          <li>Explicațiile pot menține legătura IR ↔ origins ↔ constrângeri UBH.</li>
        </ul>

        <h2>Spec-uri relevante</h2>
        <ul>
          <li><a href="../../mdview.html?file=specs/DS/006-nl-pipeline.md">DS-006</a> (typed AST contract)</li>
          <li><a href="../../mdview.html?file=specs/DS/007-nl-ubh-compile.md">DS-007</a> (compilare către UBH)</li>
          <li><a href="../../mdview.html?file=specs/DS/010-fragments-goals.md">DS-010</a> (fragment detection)</li>
        </ul>
      </div>
    </main>
  </body>
</html>

