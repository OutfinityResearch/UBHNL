<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Wiki: Hash-consing</title>
    <link rel="stylesheet" href="../../site.css" />
      <script src="../../site-nav.js" defer></script>
  </head>
  <body>
    <header>
      <h1>Hash-consing</h1>
      <p>The technique that deduplicates identical nodes, yielding structural compression.</p>
    </header>
    <main>
      <div class="card">
        <div class="draft">DRAFT: Wiki page.</div>

        <div class="nav">
          <a href="../index.html">Wiki</a>
          <a href="ubh.html">UBH</a>
          <a href="../../mdview.html?file=specs/DS/001-ir-hashcons.md">DS-001</a>
        </div>

        <h2>Definition</h2>
        <p>
          <strong>Hash-consing</strong> is a technique to represent structure as a DAG where each node is created “only once”: if you attempt to
          create the same node again (same operation + same children, in canonical form), you receive the same <a href="wire-nodeid.html">NodeId</a>.
        </p>

        <h2>Why it matters in UBHNL</h2>
        <ul>
          <li><strong>Compression</strong>: repeated sub-structures appear once and are shared (DAG, not a tree).</li>
          <li><strong>Determinism</strong>: repeated compilation of the same expression yields the same ids, enabling caching and stable explanations.</li>
          <li><strong>Efficient solving</strong>: CNF/Tseitin and XOR equations are generated once per node, not per occurrence.</li>
        </ul>

        <h2>What “the same node” means</h2>
        <p>
          “Identical” means after:
        </p>
        <ul>
          <li><strong>local simplifications</strong> (see <a href="simplification.html">simplification</a>),</li>
          <li><strong>canonicalization</strong> (e.g., for XOR/AND, ordering the inputs).</li>
        </ul>

        <h2>Consequences</h2>
        <ul>
          <li><strong>Maximum reuse</strong> in large theories (rules that generate the same patterns).</li>
          <li><strong>Clear cost model</strong>: the number of distinct nodes ≈ the size of the IR and the CNF encoding.</li>
        </ul>

        <h2>See also</h2>
        <ul>
          <li><a href="simplification.html">Local simplification</a></li>
          <li><a href="cnf.html">CNF/Tseitin</a> (why it is linear in the number of distinct AND gates)</li>
          <li><a href="../decisions/minimal-kernel.html">Decision: minimal kernel</a></li>
        </ul>
      </div>
    </main>
  </body>
</html>
